LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=3598, d=4
Generated bandwidth grid: [0.03593291 0.0599397  0.09998545 0.16678578 0.27821545 0.46409134
 0.77415102 1.29136173 2.15412119 3.59329071]
Set block size to 719 for training length 3598 and Q=4.
Best bandwidth for PRE-break model: 3.5933

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=3096, d=4
Generated bandwidth grid: [0.03661423 0.06107621 0.10188126 0.16994819 0.28349067 0.47289094
 0.78882963 1.31584713 2.1949653  3.66142279]
Set block size to 619 for training length 3096 and Q=4.
Best bandwidth for POST-break model: 3.6614

--- (3/3) Tuning gamma for Convex Combination model ---
Gamma values to test: [0.         0.01010101 0.02020202 0.03030303 0.04040404 0.05050505
 0.06060606 0.07070707 0.08080808 0.09090909 0.1010101  0.11111111
 0.12121212 0.13131313 0.14141414 0.15151515 0.16161616 0.17171717
 0.18181818 0.19191919 0.2020202  0.21212121 0.22222222 0.23232323
 0.24242424 0.25252525 0.26262626 0.27272727 0.28282828 0.29292929
 0.3030303  0.31313131 0.32323232 0.33333333 0.34343434 0.35353535
 0.36363636 0.37373737 0.38383838 0.39393939 0.4040404  0.41414141
 0.42424242 0.43434343 0.44444444 0.45454545 0.46464646 0.47474747
 0.48484848 0.49494949 0.50505051 0.51515152 0.52525253 0.53535354
 0.54545455 0.55555556 0.56565657 0.57575758 0.58585859 0.5959596
 0.60606061 0.61616162 0.62626263 0.63636364 0.64646465 0.65656566
 0.66666667 0.67676768 0.68686869 0.6969697  0.70707071 0.71717172
 0.72727273 0.73737374 0.74747475 0.75757576 0.76767677 0.77777778
 0.78787879 0.7979798  0.80808081 0.81818182 0.82828283 0.83838384
 0.84848485 0.85858586 0.86868687 0.87878788 0.88888889 0.8989899
 0.90909091 0.91919192 0.92929293 0.93939394 0.94949495 0.95959596
 0.96969697 0.97979798 0.98989899 1.        ]
Set block size to 619 for training length 3096 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.001415694694578151
Params: {'gamma': np.float64(0.010101010101010102)} MFV MSE: 0.001415683819309187
Params: {'gamma': np.float64(0.020202020202020204)} MFV MSE: 0.0014156730420704698
Params: {'gamma': np.float64(0.030303030303030304)} MFV MSE: 0.0014156623628619994
Params: {'gamma': np.float64(0.04040404040404041)} MFV MSE: 0.0014156517816837763
Params: {'gamma': np.float64(0.05050505050505051)} MFV MSE: 0.0014156412985357998
Params: {'gamma': np.float64(0.06060606060606061)} MFV MSE: 0.0014156309134180699
Params: {'gamma': np.float64(0.07070707070707072)} MFV MSE: 0.0014156206263305877
Params: {'gamma': np.float64(0.08080808080808081)} MFV MSE: 0.0014156104372733522
Params: {'gamma': np.float64(0.09090909090909091)} MFV MSE: 0.0014156003462463633
Params: {'gamma': np.float64(0.10101010101010102)} MFV MSE: 0.0014155903532496214
Params: {'gamma': np.float64(0.11111111111111112)} MFV MSE: 0.001415580458283127
Params: {'gamma': np.float64(0.12121212121212122)} MFV MSE: 0.0014155706613468788
Params: {'gamma': np.float64(0.13131313131313133)} MFV MSE: 0.0014155609624408778
Params: {'gamma': np.float64(0.14141414141414144)} MFV MSE: 0.0014155513615651237
Params: {'gamma': np.float64(0.15151515151515152)} MFV MSE: 0.0014155418587196167
Params: {'gamma': np.float64(0.16161616161616163)} MFV MSE: 0.0014155324539043568
Params: {'gamma': np.float64(0.17171717171717174)} MFV MSE: 0.001415523147119343
Params: {'gamma': np.float64(0.18181818181818182)} MFV MSE: 0.0014155139383645772
Params: {'gamma': np.float64(0.19191919191919193)} MFV MSE: 0.001415504827640058
Params: {'gamma': np.float64(0.20202020202020204)} MFV MSE: 0.0014154958149457857
Params: {'gamma': np.float64(0.21212121212121213)} MFV MSE: 0.0014154869002817596
Params: {'gamma': np.float64(0.22222222222222224)} MFV MSE: 0.0014154780836479813
Params: {'gamma': np.float64(0.23232323232323235)} MFV MSE: 0.00141546936504445
Params: {'gamma': np.float64(0.24242424242424243)} MFV MSE: 0.0014154607444711652
Params: {'gamma': np.float64(0.25252525252525254)} MFV MSE: 0.0014154522219281271
Params: {'gamma': np.float64(0.26262626262626265)} MFV MSE: 0.0014154437974153368
Params: {'gamma': np.float64(0.27272727272727276)} MFV MSE: 0.001415435470932793
Params: {'gamma': np.float64(0.2828282828282829)} MFV MSE: 0.0014154272424804959
Params: {'gamma': np.float64(0.29292929292929293)} MFV MSE: 0.0014154191120584456
Params: {'gamma': np.float64(0.30303030303030304)} MFV MSE: 0.0014154110796666427
Params: {'gamma': np.float64(0.31313131313131315)} MFV MSE: 0.0014154031453050865
Params: {'gamma': np.float64(0.32323232323232326)} MFV MSE: 0.0014153953089737772
Params: {'gamma': np.float64(0.33333333333333337)} MFV MSE: 0.0014153875706727152
Params: {'gamma': np.float64(0.3434343434343435)} MFV MSE: 0.0014153799304018997
Params: {'gamma': np.float64(0.3535353535353536)} MFV MSE: 0.0014153723881613314
Params: {'gamma': np.float64(0.36363636363636365)} MFV MSE: 0.0014153649439510097
Params: {'gamma': np.float64(0.37373737373737376)} MFV MSE: 0.0014153575977709353
Params: {'gamma': np.float64(0.38383838383838387)} MFV MSE: 0.0014153503496211078
Params: {'gamma': np.float64(0.393939393939394)} MFV MSE: 0.0014153431995015274
Params: {'gamma': np.float64(0.4040404040404041)} MFV MSE: 0.0014153361474121935
Params: {'gamma': np.float64(0.4141414141414142)} MFV MSE: 0.0014153291933531064
Params: {'gamma': np.float64(0.42424242424242425)} MFV MSE: 0.0014153223373242667
Params: {'gamma': np.float64(0.43434343434343436)} MFV MSE: 0.0014153155793256737
Params: {'gamma': np.float64(0.4444444444444445)} MFV MSE: 0.001415308919357328
Params: {'gamma': np.float64(0.4545454545454546)} MFV MSE: 0.001415302357419229
Params: {'gamma': np.float64(0.4646464646464647)} MFV MSE: 0.0014152958935113767
Params: {'gamma': np.float64(0.4747474747474748)} MFV MSE: 0.0014152895276337712
Params: {'gamma': np.float64(0.48484848484848486)} MFV MSE: 0.0014152832597864131
Params: {'gamma': np.float64(0.494949494949495)} MFV MSE: 0.0014152770899693017
Params: {'gamma': np.float64(0.5050505050505051)} MFV MSE: 0.0014152710181824372
Params: {'gamma': np.float64(0.5151515151515152)} MFV MSE: 0.0014152650444258198
Params: {'gamma': np.float64(0.5252525252525253)} MFV MSE: 0.0014152591686994495
Params: {'gamma': np.float64(0.5353535353535354)} MFV MSE: 0.0014152533910033259
Params: {'gamma': np.float64(0.5454545454545455)} MFV MSE: 0.0014152477113374491
Params: {'gamma': np.float64(0.5555555555555556)} MFV MSE: 0.0014152421297018193
Params: {'gamma': np.float64(0.5656565656565657)} MFV MSE: 0.0014152366460964366
Params: {'gamma': np.float64(0.5757575757575758)} MFV MSE: 0.0014152312605213006
Params: {'gamma': np.float64(0.5858585858585859)} MFV MSE: 0.0014152259729764119
Params: {'gamma': np.float64(0.595959595959596)} MFV MSE: 0.00141522078346177
Params: {'gamma': np.float64(0.6060606060606061)} MFV MSE: 0.001415215691977375
Params: {'gamma': np.float64(0.6161616161616162)} MFV MSE: 0.0014152106985232265
Params: {'gamma': np.float64(0.6262626262626263)} MFV MSE: 0.0014152058030993256
Params: {'gamma': np.float64(0.6363636363636365)} MFV MSE: 0.0014152010057056714
Params: {'gamma': np.float64(0.6464646464646465)} MFV MSE: 0.0014151963063422641
Params: {'gamma': np.float64(0.6565656565656566)} MFV MSE: 0.0014151917050091037
Params: {'gamma': np.float64(0.6666666666666667)} MFV MSE: 0.0014151872017061902
Params: {'gamma': np.float64(0.6767676767676768)} MFV MSE: 0.0014151827964335238
Params: {'gamma': np.float64(0.686868686868687)} MFV MSE: 0.001415178489191104
Params: {'gamma': np.float64(0.696969696969697)} MFV MSE: 0.0014151742799789313
Params: {'gamma': np.float64(0.7070707070707072)} MFV MSE: 0.001415170168797006
Params: {'gamma': np.float64(0.7171717171717172)} MFV MSE: 0.0014151661556453272
Params: {'gamma': np.float64(0.7272727272727273)} MFV MSE: 0.0014151622405238953
Params: {'gamma': np.float64(0.7373737373737375)} MFV MSE: 0.0014151584234327105
Params: {'gamma': np.float64(0.7474747474747475)} MFV MSE: 0.0014151547043717721
Params: {'gamma': np.float64(0.7575757575757577)} MFV MSE: 0.0014151510833410811
Params: {'gamma': np.float64(0.7676767676767677)} MFV MSE: 0.0014151475603406372
Params: {'gamma': np.float64(0.7777777777777778)} MFV MSE: 0.00141514413537044
Params: {'gamma': np.float64(0.787878787878788)} MFV MSE: 0.0014151408084304897
Params: {'gamma': np.float64(0.797979797979798)} MFV MSE: 0.0014151375795207865
Params: {'gamma': np.float64(0.8080808080808082)} MFV MSE: 0.0014151344486413298
Params: {'gamma': np.float64(0.8181818181818182)} MFV MSE: 0.0014151314157921204
Params: {'gamma': np.float64(0.8282828282828284)} MFV MSE: 0.0014151284809731583
Params: {'gamma': np.float64(0.8383838383838385)} MFV MSE: 0.0014151256441844425
Params: {'gamma': np.float64(0.8484848484848485)} MFV MSE: 0.0014151229054259738
Params: {'gamma': np.float64(0.8585858585858587)} MFV MSE: 0.0014151202646977522
Params: {'gamma': np.float64(0.8686868686868687)} MFV MSE: 0.001415117721999778
Params: {'gamma': np.float64(0.8787878787878789)} MFV MSE: 0.00141511527733205
Params: {'gamma': np.float64(0.888888888888889)} MFV MSE: 0.0014151129306945688
Params: {'gamma': np.float64(0.8989898989898991)} MFV MSE: 0.001415110682087335
Params: {'gamma': np.float64(0.9090909090909092)} MFV MSE: 0.0014151085315103479
Params: {'gamma': np.float64(0.9191919191919192)} MFV MSE: 0.0014151064789636077
Params: {'gamma': np.float64(0.9292929292929294)} MFV MSE: 0.0014151045244471146
Params: {'gamma': np.float64(0.9393939393939394)} MFV MSE: 0.0014151026679608684
Params: {'gamma': np.float64(0.9494949494949496)} MFV MSE: 0.001415100909504869
Params: {'gamma': np.float64(0.9595959595959597)} MFV MSE: 0.0014150992490791169
Params: {'gamma': np.float64(0.9696969696969697)} MFV MSE: 0.001415097686683611
Params: {'gamma': np.float64(0.9797979797979799)} MFV MSE: 0.0014150962223183525
Params: {'gamma': np.float64(0.98989898989899)} MFV MSE: 0.0014150948559833408
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0014150935876785767
Best gamma: 1.00 (MFV MSE: 0.001415), where gamma is the weight on the pre-break model.

--- Starting Bias-Variance Decomposition ---
Starting bias-variance decomposition with 50 rounds...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 10/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 20/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 30/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 40/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 50/50...
Decomposition complete.
OOS Metrics: {'MSFE': 0.0009823242596051526, 'RMSE': np.float64(0.03134205257485784), 'MAE': 0.02309792541740401}

--- Bias-Variance Decomposition Results ---
  MSE (from BVD): 0.000988
  Bias^2:         0.000986
  Variance:       0.000001
  Bias^2 + Var:   0.000988
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125429_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125429_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
