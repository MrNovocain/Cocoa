LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=1800, d=2
Generated bandwidth grid: [0.02867178 0.0478274  0.07978092 0.13308259 0.22199514 0.37031022
 0.61771467 1.03041017 1.71882776 2.86717752]
Set block size to 360 for training length 1800 and Q=4.
Best bandwidth for PRE-break model: 0.6177

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=4872, d=2
Generated bandwidth grid: [0.02428746 0.04051393 0.0675813  0.11273241 0.18804899 0.31368462
 0.52325749 0.8728461  1.45599505 2.42874612]
Set block size to 974 for training length 4872 and Q=4.
Best bandwidth for POST-break model: 0.3137

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 974 for training length 4872 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0009930605063715368
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0009906537934751298
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.000988383817044921
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0009862505770809105
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0009842540735830988
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.000982394306551485
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.00098067127598607
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0009790849818868527
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0009776354242538342
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0009763226030870141
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0009751465183863924
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.000974107170151969
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0009732045583837441
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0009724386830817173
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0009718095442458887
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0009713171418762587
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0009709614759728271
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0009707425465355938
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0009706603535645588
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0009707148970597221
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.000970906177021084
Best gamma: 0.90 (MFV MSE: 0.000971), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0013913379527930622, 'RMSE': np.float64(0.037300642793295966), 'MAE': 0.028612941118853832}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_180003_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_180003_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
