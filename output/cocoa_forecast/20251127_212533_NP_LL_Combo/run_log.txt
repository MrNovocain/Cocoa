LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=2199, d=4
Generated bandwidth grid: [0.03821394 0.0637447  0.10633257 0.17737341 0.29587668 0.49355205
 0.82329443 1.37333789 2.29086567 3.82139425]
Set block size to 439 for training length 2199 and Q=4.
Best bandwidth for PRE-break model: 3.8214

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=4495, d=4
Generated bandwidth grid: [0.03494691 0.05829496 0.09724185 0.16220919 0.27058124 0.45135671
 0.75290836 1.25592685 2.09501225 3.49469105]
Set block size to 899 for training length 4495 and Q=4.
Best bandwidth for POST-break model: 3.4947

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 899 for training length 4495 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.001040252139871376
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0010400638066383797
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0010398837742695791
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0010397120427649742
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0010395486121245654
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0010393934823483522
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.001039246653436335
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0010391081253885133
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0010389778982048876
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.001038855971885458
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0010387423464302235
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.001038637021839185
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0010385399981123428
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0010384512752496958
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.001038370853251245
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.00103829873211699
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0010382349118469307
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.001038179392441067
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0010381321738993994
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0010380932562219275
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0010380626394086514
Best gamma: 1.00 (MFV MSE: 0.001038), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0009856345835988118, 'RMSE': np.float64(0.03139481778253876), 'MAE': 0.02315852213599876}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_212533_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_212533_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
