LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=299, d=4
Generated bandwidth grid: [0.04903894 0.08180189 0.13645377 0.22761861 0.37969073 0.63336231
 1.056512   1.76236824 2.9398074  4.90389431]
Set block size to 59 for training length 299 and Q=4.
Best bandwidth for PRE-break model: 4.9039

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=6395, d=4
Generated bandwidth grid: [0.03344028 0.05578175 0.09304957 0.15521604 0.25891596 0.43189785
 0.72044904 1.20178142 2.00469224 3.3440282 ]
Set block size to 1279 for training length 6395 and Q=4.
Best bandwidth for POST-break model: 3.3440

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 1279 for training length 6395 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0008279226079245546
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0008278444690514223
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.000827773805096125
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0008277106160586626
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.000827654901939035
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0008276066627372423
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0008275658984532846
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0008275326090871616
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0008275067946388736
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0008274884551084204
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0008274775904958024
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.000827474200801019
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0008274782860240705
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.000827489846164957
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0008275088812236786
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0008275353912002347
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0008275693760946259
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.000827610835906852
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0008276597706369131
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0008277161802848088
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0008277800648505396
Best gamma: 0.55 (MFV MSE: 0.000827), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0009909413694376228, 'RMSE': np.float64(0.03147922123302327), 'MAE': 0.023265500255199544}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_212502_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_212502_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
