Creating bandwidth grid with T=1338, d=4
Generated bandwidth grid: [0.0406624  0.06782897 0.11314554 0.18873813 0.31483418 0.52517506
 0.87604481 1.46133081 2.43764671 4.06623979]
Set block size to 267 for training length 1338 and Q=4.
Params: {'bandwidth': np.float64(0.04066239790076265)} MFV MSE: 0.003292290182973576
Params: {'bandwidth': np.float64(0.0678289677821047)} MFV MSE: 0.0033531759063068875
Params: {'bandwidth': np.float64(0.11314553759505433)} MFV MSE: 0.0032572826608590023
Params: {'bandwidth': np.float64(0.18873813204409956)} MFV MSE: 0.003121303474404813
Params: {'bandwidth': np.float64(0.3148341794528981)} MFV MSE: 0.003044598899366545
Params: {'bandwidth': np.float64(0.5251750638743192)} MFV MSE: 0.003025493391712124
Params: {'bandwidth': np.float64(0.8760448061728267)} MFV MSE: 0.0030154539390647617
Params: {'bandwidth': np.float64(1.4613308117882131)} MFV MSE: 0.0030074743072363136
Params: {'bandwidth': np.float64(2.437646712170917)} MFV MSE: 0.0030059636994397895
Params: {'bandwidth': np.float64(4.066239790076264)} MFV MSE: 0.003005598705020668
Best params for NP_LL_Post: {'bandwidth': np.float64(4.066239790076264)} (MFV MSE: 0.003006)

--- Starting Bias-Variance Decomposition ---
Starting bias-variance decomposition with 50 rounds...
  Completed round 10/50...
  Completed round 20/50...
  Completed round 30/50...
  Completed round 40/50...
  Completed round 50/50...
Decomposition complete.
OOS Metrics: {'MSFE': 0.001002356231219906, 'RMSE': np.float64(0.031660009968727205), 'MAE': 0.023887357240747288}

--- Bias-Variance Decomposition Results ---
  MSE (from BVD): 0.001008
  Bias^2:         0.000998
  Variance:       0.000010
  Bias^2 + Var:   0.001008
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_113035_NP_LL_Post\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_113035_NP_LL_Post\oos_forecast.png
Successfully completed run for NP_LL_Post.
