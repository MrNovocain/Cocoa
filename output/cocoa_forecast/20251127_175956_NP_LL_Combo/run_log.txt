LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=1300, d=2
Generated bandwidth grid: [0.03026979 0.05049306 0.0842275  0.14049993 0.23436801 0.3909494
 0.65214291 1.08783993 1.81462638 3.02697923]
Set block size to 260 for training length 1300 and Q=4.
Best bandwidth for PRE-break model: 3.0270

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=5372, d=2
Generated bandwidth grid: [0.0238952  0.0398596  0.06648981 0.11091169 0.18501185 0.30861837
 0.51480647 0.85874895 1.43247959 2.38951998]
Set block size to 1074 for training length 5372 and Q=4.
Best bandwidth for POST-break model: 0.3086

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 1074 for training length 5372 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.000930671416671662
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0009308186900214869
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0009310010408496284
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0009312184691560864
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.000931470974940861
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0009317585582039523
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0009320812189453603
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0009324389571650843
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0009328317728631257
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0009332596660394833
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0009337226366941577
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0009342206848271487
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0009347538104384563
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0009353220135280806
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0009359252940960214
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0009365636521422786
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0009372370876668529
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0009379456006697438
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0009386891911509511
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.000939467859110475
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0009402816045483154
Best gamma: 0.00 (MFV MSE: 0.000931), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.004718097092005891, 'RMSE': np.float64(0.06868840580480734), 'MAE': 0.06168021418518841}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_175956_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_175956_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
