LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=3597, d=4
Generated bandwidth grid: [0.03593416 0.05994178 0.09998892 0.16679158 0.27822512 0.46410747
 0.77417792 1.2914066  2.15419604 3.59341557]
Set block size to 719 for training length 3597 and Q=4.
Best bandwidth for PRE-break model: 3.5934

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=3097, d=4
Generated bandwidth grid: [0.03661275 0.06107375 0.10187715 0.16994133 0.28347923 0.47287185
 0.78879779 1.31579401 2.19487669 3.66127499]
Set block size to 619 for training length 3097 and Q=4.
Best bandwidth for POST-break model: 3.6613

--- (3/3) Tuning gamma for Convex Combination model ---
Gamma values to test: [0.         0.01010101 0.02020202 0.03030303 0.04040404 0.05050505
 0.06060606 0.07070707 0.08080808 0.09090909 0.1010101  0.11111111
 0.12121212 0.13131313 0.14141414 0.15151515 0.16161616 0.17171717
 0.18181818 0.19191919 0.2020202  0.21212121 0.22222222 0.23232323
 0.24242424 0.25252525 0.26262626 0.27272727 0.28282828 0.29292929
 0.3030303  0.31313131 0.32323232 0.33333333 0.34343434 0.35353535
 0.36363636 0.37373737 0.38383838 0.39393939 0.4040404  0.41414141
 0.42424242 0.43434343 0.44444444 0.45454545 0.46464646 0.47474747
 0.48484848 0.49494949 0.50505051 0.51515152 0.52525253 0.53535354
 0.54545455 0.55555556 0.56565657 0.57575758 0.58585859 0.5959596
 0.60606061 0.61616162 0.62626263 0.63636364 0.64646465 0.65656566
 0.66666667 0.67676768 0.68686869 0.6969697  0.70707071 0.71717172
 0.72727273 0.73737374 0.74747475 0.75757576 0.76767677 0.77777778
 0.78787879 0.7979798  0.80808081 0.81818182 0.82828283 0.83838384
 0.84848485 0.85858586 0.86868687 0.87878788 0.88888889 0.8989899
 0.90909091 0.91919192 0.92929293 0.93939394 0.94949495 0.95959596
 0.96969697 0.97979798 0.98989899 1.        ]
Set block size to 619 for training length 3097 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0014156951322988874
Params: {'gamma': np.float64(0.010101010101010102)} MFV MSE: 0.001415684258740051
Params: {'gamma': np.float64(0.020202020202020204)} MFV MSE: 0.0014156734830863276
Params: {'gamma': np.float64(0.030303030303030304)} MFV MSE: 0.0014156628053377176
Params: {'gamma': np.float64(0.04040404040404041)} MFV MSE: 0.001415652225494221
Params: {'gamma': np.float64(0.05050505050505051)} MFV MSE: 0.0014156417435558372
Params: {'gamma': np.float64(0.06060606060606061)} MFV MSE: 0.0014156313595225674
Params: {'gamma': np.float64(0.07070707070707072)} MFV MSE: 0.00141562107339441
Params: {'gamma': np.float64(0.08080808080808081)} MFV MSE: 0.0014156108851713668
Params: {'gamma': np.float64(0.09090909090909091)} MFV MSE: 0.0014156007948534365
Params: {'gamma': np.float64(0.10101010101010102)} MFV MSE: 0.001415590802440619
Params: {'gamma': np.float64(0.11111111111111112)} MFV MSE: 0.0014155809079329153
Params: {'gamma': np.float64(0.12121212121212122)} MFV MSE: 0.0014155711113303248
Params: {'gamma': np.float64(0.13131313131313133)} MFV MSE: 0.0014155614126328477
Params: {'gamma': np.float64(0.14141414141414144)} MFV MSE: 0.0014155518118404839
Params: {'gamma': np.float64(0.15151515151515152)} MFV MSE: 0.0014155423089532329
Params: {'gamma': np.float64(0.16161616161616163)} MFV MSE: 0.0014155329039710956
Params: {'gamma': np.float64(0.17171717171717174)} MFV MSE: 0.0014155235968940716
Params: {'gamma': np.float64(0.18181818181818182)} MFV MSE: 0.0014155143877221607
Params: {'gamma': np.float64(0.19191919191919193)} MFV MSE: 0.001415505276455363
Params: {'gamma': np.float64(0.20202020202020204)} MFV MSE: 0.0014154962630936786
Params: {'gamma': np.float64(0.21212121212121213)} MFV MSE: 0.0014154873476371075
Params: {'gamma': np.float64(0.22222222222222224)} MFV MSE: 0.00141547853008565
Params: {'gamma': np.float64(0.23232323232323235)} MFV MSE: 0.0014154698104393052
Params: {'gamma': np.float64(0.24242424242424243)} MFV MSE: 0.001415461188698074
Params: {'gamma': np.float64(0.25252525252525254)} MFV MSE: 0.0014154526648619563
Params: {'gamma': np.float64(0.26262626262626265)} MFV MSE: 0.0014154442389309515
Params: {'gamma': np.float64(0.27272727272727276)} MFV MSE: 0.0014154359109050602
Params: {'gamma': np.float64(0.2828282828282829)} MFV MSE: 0.0014154276807842826
Params: {'gamma': np.float64(0.29292929292929293)} MFV MSE: 0.0014154195485686174
Params: {'gamma': np.float64(0.30303030303030304)} MFV MSE: 0.001415411514258066
Params: {'gamma': np.float64(0.31313131313131315)} MFV MSE: 0.001415403577852628
Params: {'gamma': np.float64(0.32323232323232326)} MFV MSE: 0.0014153957393523032
Params: {'gamma': np.float64(0.33333333333333337)} MFV MSE: 0.0014153879987570909
Params: {'gamma': np.float64(0.3434343434343435)} MFV MSE: 0.0014153803560669927
Params: {'gamma': np.float64(0.3535353535353536)} MFV MSE: 0.0014153728112820075
Params: {'gamma': np.float64(0.36363636363636365)} MFV MSE: 0.0014153653644021357
Params: {'gamma': np.float64(0.37373737373737376)} MFV MSE: 0.0014153580154273768
Params: {'gamma': np.float64(0.38383838383838387)} MFV MSE: 0.0014153507643577317
Params: {'gamma': np.float64(0.393939393939394)} MFV MSE: 0.0014153436111932
Params: {'gamma': np.float64(0.4040404040404041)} MFV MSE: 0.0014153365559337811
Params: {'gamma': np.float64(0.4141414141414142)} MFV MSE: 0.0014153295985794754
Params: {'gamma': np.float64(0.42424242424242425)} MFV MSE: 0.0014153227391302833
Params: {'gamma': np.float64(0.43434343434343436)} MFV MSE: 0.0014153159775862046
Params: {'gamma': np.float64(0.4444444444444445)} MFV MSE: 0.001415309313947239
Params: {'gamma': np.float64(0.4545454545454546)} MFV MSE: 0.0014153027482133862
Params: {'gamma': np.float64(0.4646464646464647)} MFV MSE: 0.0014152962803846473
Params: {'gamma': np.float64(0.4747474747474748)} MFV MSE: 0.0014152899104610214
Params: {'gamma': np.float64(0.48484848484848486)} MFV MSE: 0.001415283638442509
Params: {'gamma': np.float64(0.494949494949495)} MFV MSE: 0.0014152774643291096
Params: {'gamma': np.float64(0.5050505050505051)} MFV MSE: 0.001415271388120824
Params: {'gamma': np.float64(0.5151515151515152)} MFV MSE: 0.0014152654098176514
Params: {'gamma': np.float64(0.5252525252525253)} MFV MSE: 0.0014152595294195918
Params: {'gamma': np.float64(0.5353535353535354)} MFV MSE: 0.0014152537469266455
Params: {'gamma': np.float64(0.5454545454545455)} MFV MSE: 0.001415248062338813
Params: {'gamma': np.float64(0.5555555555555556)} MFV MSE: 0.0014152424756560932
Params: {'gamma': np.float64(0.5656565656565657)} MFV MSE: 0.001415236986878487
Params: {'gamma': np.float64(0.5757575757575758)} MFV MSE: 0.0014152315960059942
Params: {'gamma': np.float64(0.5858585858585859)} MFV MSE: 0.0014152263030386145
Params: {'gamma': np.float64(0.595959595959596)} MFV MSE: 0.0014152211079763476
Params: {'gamma': np.float64(0.6060606060606061)} MFV MSE: 0.0014152160108191945
Params: {'gamma': np.float64(0.6161616161616162)} MFV MSE: 0.0014152110115671546
Params: {'gamma': np.float64(0.6262626262626263)} MFV MSE: 0.001415206110220228
Params: {'gamma': np.float64(0.6363636363636365)} MFV MSE: 0.0014152013067784146
Params: {'gamma': np.float64(0.6464646464646465)} MFV MSE: 0.0014151966012417145
Params: {'gamma': np.float64(0.6565656565656566)} MFV MSE: 0.0014151919936101277
Params: {'gamma': np.float64(0.6666666666666667)} MFV MSE: 0.0014151874838836539
Params: {'gamma': np.float64(0.6767676767676768)} MFV MSE: 0.0014151830720622938
Params: {'gamma': np.float64(0.686868686868687)} MFV MSE: 0.0014151787581460468
Params: {'gamma': np.float64(0.696969696969697)} MFV MSE: 0.0014151745421349133
Params: {'gamma': np.float64(0.7070707070707072)} MFV MSE: 0.0014151704240288926
Params: {'gamma': np.float64(0.7171717171717172)} MFV MSE: 0.0014151664038279854
Params: {'gamma': np.float64(0.7272727272727273)} MFV MSE: 0.001415162481532192
Params: {'gamma': np.float64(0.7373737373737375)} MFV MSE: 0.001415158657141511
Params: {'gamma': np.float64(0.7474747474747475)} MFV MSE: 0.0014151549306559439
Params: {'gamma': np.float64(0.7575757575757577)} MFV MSE: 0.00141515130207549
Params: {'gamma': np.float64(0.7676767676767677)} MFV MSE: 0.0014151477714001491
Params: {'gamma': np.float64(0.7777777777777778)} MFV MSE: 0.0014151443386299218
Params: {'gamma': np.float64(0.787878787878788)} MFV MSE: 0.0014151410037648072
Params: {'gamma': np.float64(0.797979797979798)} MFV MSE: 0.0014151377668048068
Params: {'gamma': np.float64(0.8080808080808082)} MFV MSE: 0.0014151346277499186
Params: {'gamma': np.float64(0.8181818181818182)} MFV MSE: 0.0014151315866001448
Params: {'gamma': np.float64(0.8282828282828284)} MFV MSE: 0.0014151286433554831
Params: {'gamma': np.float64(0.8383838383838385)} MFV MSE: 0.0014151257980159356
Params: {'gamma': np.float64(0.8484848484848485)} MFV MSE: 0.0014151230505815013
Params: {'gamma': np.float64(0.8585858585858587)} MFV MSE: 0.00141512040105218
Params: {'gamma': np.float64(0.8686868686868687)} MFV MSE: 0.001415117849427972
Params: {'gamma': np.float64(0.8787878787878789)} MFV MSE: 0.001415115395708877
Params: {'gamma': np.float64(0.888888888888889)} MFV MSE: 0.0014151130398948957
Params: {'gamma': np.float64(0.8989898989898991)} MFV MSE: 0.0014151107819860276
Params: {'gamma': np.float64(0.9090909090909092)} MFV MSE: 0.0014151086219822725
Params: {'gamma': np.float64(0.9191919191919192)} MFV MSE: 0.0014151065598836312
Params: {'gamma': np.float64(0.9292929292929294)} MFV MSE: 0.001415104595690103
Params: {'gamma': np.float64(0.9393939393939394)} MFV MSE: 0.001415102729401688
Params: {'gamma': np.float64(0.9494949494949496)} MFV MSE: 0.0014151009610183863
Params: {'gamma': np.float64(0.9595959595959597)} MFV MSE: 0.001415099290540198
Params: {'gamma': np.float64(0.9696969696969697)} MFV MSE: 0.0014150977179671225
Params: {'gamma': np.float64(0.9797979797979799)} MFV MSE: 0.0014150962432991606
Params: {'gamma': np.float64(0.98989898989899)} MFV MSE: 0.001415094866536312
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0014150935876785767
Best gamma: 1.00 (MFV MSE: 0.001415), where gamma is the weight on the pre-break model.

--- Starting Bias-Variance Decomposition ---
Starting bias-variance decomposition with 50 rounds...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 10/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 20/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 30/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 40/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 50/50...
Decomposition complete.
OOS Metrics: {'MSFE': 0.0009823126021256963, 'RMSE': np.float64(0.03134186660244881), 'MAE': 0.023097840274875603}

--- Bias-Variance Decomposition Results ---
  MSE (from BVD): 0.000988
  Bias^2:         0.000986
  Variance:       0.000001
  Bias^2 + Var:   0.000988
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125427_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125427_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
