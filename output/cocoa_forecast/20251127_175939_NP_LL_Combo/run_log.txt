LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=200, d=2
Generated bandwidth grid: [0.04135186 0.06897905 0.11506399 0.19193831 0.3201724  0.53407975
 0.89089872 1.48610863 2.4789786  4.13518554]
Set block size to 40 for training length 200 and Q=4.
Best bandwidth for PRE-break model: 0.5341

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=6472, d=2
Generated bandwidth grid: [0.02316471 0.03864107 0.06445719 0.10752107 0.17935596 0.29918377
 0.4990686  0.8324966  1.38868803 2.31647125]
Set block size to 1294 for training length 6472 and Q=4.
Best bandwidth for POST-break model: 0.2992

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 1294 for training length 6472 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0008162245997809431
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0008172425048835911
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0008187124237060812
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0008206343562484132
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0008230083025105879
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0008258342624926044
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0008291122361944629
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0008328422236161639
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0008370242247577066
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0008416582396190919
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0008467442682003189
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0008522823105013883
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0008582723665223
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0008647144362630536
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0008716085197236494
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0008789546169040871
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0008867527278043673
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0008950028524244895
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0009037049907644541
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0009128591428242605
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.000922465308603909
Best gamma: 0.00 (MFV MSE: 0.000816), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.005133010643365174, 'RMSE': np.float64(0.07164503223088935), 'MAE': 0.0646037321415407}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_175939_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_175939_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
