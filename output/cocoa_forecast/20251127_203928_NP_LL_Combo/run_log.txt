LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=999, d=2
Generated bandwidth grid: [0.03162805 0.05275877 0.08800693 0.1468044  0.24488451 0.40849198
 0.68140568 1.13665319 1.89605179 3.16280501]
Set block size to 199 for training length 999 and Q=4.
Best bandwidth for PRE-break model: 1.8961

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=5695, d=2
Generated bandwidth grid: [0.02366379 0.03947359 0.06584591 0.1098376  0.18322016 0.30562965
 0.50982099 0.85043267 1.41860719 2.36637941]
Set block size to 1139 for training length 5695 and Q=4.
Best bandwidth for POST-break model: 2.3664

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 1139 for training length 5695 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0008923619550517786
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0008918137676722477
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0008913081964784494
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0008908452414703842
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0008904249026480515
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.000890047180011451
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0008897120735605835
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0008894195832954487
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0008891697092160462
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0008889624513223767
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0008887978096144397
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0008886757840922352
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0008885963747557636
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0008885595816050246
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0008885654046400178
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.000888613843860744
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0008887048992672028
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0008888385708593942
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0008890148586373184
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0008892337626009751
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0008894952827503643
Best gamma: 0.65 (MFV MSE: 0.000889), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0009642229310199373, 'RMSE': np.float64(0.03105193924733103), 'MAE': 0.02277631274470515}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_203928_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_203928_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
