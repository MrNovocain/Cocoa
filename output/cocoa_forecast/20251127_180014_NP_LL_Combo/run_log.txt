LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=2700, d=2
Generated bandwidth grid: [0.02679823 0.04470213 0.07456765 0.12438634 0.20748893 0.34611239
 0.57735027 0.96307829 1.60651142 2.67982256]
Set block size to 540 for training length 2700 and Q=4.
Best bandwidth for PRE-break model: 2.6798

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=3972, d=2
Generated bandwidth grid: [0.02512842 0.04191673 0.06992131 0.11663578 0.19456021 0.32454598
 0.54137533 0.90306848 1.50640901 2.51284168]
Set block size to 794 for training length 3972 and Q=4.
Best bandwidth for POST-break model: 0.3245

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 794 for training length 3972 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.00115135757677575
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0011489562556688535
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0011466510704672324
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0011444420211708865
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0011423291077798155
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.00114031233029402
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0011383916887134997
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.001136567183038255
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.001134838813268285
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0011332065794035905
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.001131670481444171
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0011302305193900272
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.001128886693241158
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0011276390029975646
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0011264874486592463
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0011254320302262028
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0011244727476984347
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.001123609601075942
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0011228425903587243
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0011221717155467821
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.001121596976640115
Best gamma: 1.00 (MFV MSE: 0.001122), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0013090619870635971, 'RMSE': np.float64(0.03618096166582084), 'MAE': 0.02688923605227198}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_180014_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_180014_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
