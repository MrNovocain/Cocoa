LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=1599, d=4
Generated bandwidth grid: [0.03976664 0.06633476 0.11065305 0.18458041 0.30789868 0.51360596
 0.85674637 1.42913909 2.38394768 3.97666441]
Set block size to 319 for training length 1599 and Q=4.
Best bandwidth for PRE-break model: 3.9767

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=5095, d=4
Generated bandwidth grid: [0.03440384 0.05738907 0.09573074 0.1596885  0.26637647 0.44434274
 0.74120836 1.23641007 2.06245629 3.44038445]
Set block size to 1019 for training length 5095 and Q=4.
Best bandwidth for POST-break model: 3.4404

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 1019 for training length 5095 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0009617753541199973
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0009616222290189007
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0009614797474529165
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0009613479094220445
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0009612267149262849
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0009611161639656375
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0009610162565401022
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0009609269926496794
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0009608483722943688
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0009607803954741706
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0009607230621890849
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0009606763724391112
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0009606403262242499
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0009606149235445008
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0009606001643998641
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0009605960487903396
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0009606025767159277
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0009606197481766278
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0009606475631724402
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0009606860217033648
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0009607351237694017
Best gamma: 0.75 (MFV MSE: 0.000961), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0009848884161456951, 'RMSE': np.float64(0.03138293192398848), 'MAE': 0.023103751223016868}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_212525_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_212525_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
