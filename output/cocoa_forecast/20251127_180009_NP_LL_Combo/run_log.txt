LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=2300, d=2
Generated bandwidth grid: [0.02752403 0.04591285 0.07658725 0.12775523 0.21310857 0.35548652
 0.59298726 0.98916236 1.65002227 2.75240303]
Set block size to 460 for training length 2300 and Q=4.
Best bandwidth for PRE-break model: 2.7524

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=4372, d=2
Generated bandwidth grid: [0.02472976 0.04125173 0.06881204 0.1147854  0.19147358 0.31939719
 0.53278662 0.88874164 1.48251041 2.47297641]
Set block size to 874 for training length 4372 and Q=4.
Best bandwidth for POST-break model: 2.4730

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 874 for training length 4372 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0010718440022914383
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0010699387864730365
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0010681194790770694
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0010663860801035357
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0010647385895524366
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0010631770074237715
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0010617013337175403
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0010603115684337432
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0010590077115723803
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0010577897631334516
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0010566577231169564
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0010556115915228957
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.001054651368351269
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.001053777053602076
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.001052988647275318
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0010522861493709932
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0010516695598891024
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0010511388788296463
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0010506941061926242
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0010503352419780358
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0010500622861858815
Best gamma: 1.00 (MFV MSE: 0.001050), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0013393615439988103, 'RMSE': np.float64(0.036597288752021104), 'MAE': 0.027447960934775868}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_180009_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_180009_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
