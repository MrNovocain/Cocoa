LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=2500, d=2
Generated bandwidth grid: [0.02714418 0.04527921 0.07553028 0.1259921  0.2101675  0.35058052
 0.58480355 0.97551111 1.62725061 2.71441762]
Set block size to 500 for training length 2500 and Q=4.
Best bandwidth for PRE-break model: 0.9755

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=4172, d=2
Generated bandwidth grid: [0.02492351 0.04157493 0.06935116 0.11568471 0.19297372 0.32189957
 0.53696084 0.89570467 1.49412544 2.49235145]
Set block size to 834 for training length 4172 and Q=4.
Best bandwidth for POST-break model: 0.3219

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 834 for training length 4172 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.005732214208878491
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.005281481919829069
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.004853762069121574
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.004449054656756002
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.004067359682732354
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.003708677147050631
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0033730070497108313
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0030603493907129567
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0027707041700570064
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0025040713877429815
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0022604510437708794
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0020398431381407024
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.001842247670852449
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0016676646419061213
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0015160940513017174
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0013875358990392374
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0012819901851186823
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0011994569095400514
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0011399360723033452
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.001103427673408563
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0010899317128557052
Best gamma: 1.00 (MFV MSE: 0.001090), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0013326880495741944, 'RMSE': np.float64(0.036506000185917306), 'MAE': 0.027311266256064354}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_182001_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_182001_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
