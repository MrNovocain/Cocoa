LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=500, d=2
Generated bandwidth grid: [0.03549537 0.05920984 0.09876797 0.1647549  0.27482773 0.45844029
 0.76472449 1.27563733 2.12789132 3.54953666]
Set block size to 100 for training length 500 and Q=4.
Best bandwidth for PRE-break model: 0.7647

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=6172, d=2
Generated bandwidth grid: [0.02334868 0.03894795 0.06496909 0.10837498 0.18078036 0.30155981
 0.50303208 0.83910808 1.39971664 2.33486808]
Set block size to 1234 for training length 6172 and Q=4.
Best bandwidth for POST-break model: 0.8391

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 1234 for training length 6172 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0008379439785148368
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0008379422677916167
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0008379594927315502
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0008379956533346368
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.000838050749600877
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0008381247815302703
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0008382177491228168
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0008383296523785165
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0008384604912973698
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0008386102658793762
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0008387789761245359
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0008389666220328495
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0008391732036043156
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0008393987208389353
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0008396431737367081
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0008399065622976345
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0008401888865217143
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0008404901464089469
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0008408103419593331
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0008411494731728724
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0008415075400495652
Best gamma: 0.05 (MFV MSE: 0.000838), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0013012246524982205, 'RMSE': np.float64(0.036072491631411054), 'MAE': 0.02679411451101553}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_175944_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_175944_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
