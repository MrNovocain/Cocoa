LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=3592, d=4
Generated bandwidth grid: [0.0359404  0.05995221 0.10000631 0.16682058 0.2782735  0.46418817
 0.77431254 1.29163116 2.15457064 3.59404044]
Set block size to 718 for training length 3592 and Q=4.
Best bandwidth for PRE-break model: 3.5940

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=3102, d=4
Generated bandwidth grid: [0.03660537 0.06106143 0.10185661 0.16990707 0.28342207 0.47277651
 0.78863874 1.31552871 2.19443415 3.66053679]
Set block size to 620 for training length 3102 and Q=4.
Best bandwidth for POST-break model: 3.6605

--- (3/3) Tuning gamma for Convex Combination model ---
Gamma values to test: [0.         0.01010101 0.02020202 0.03030303 0.04040404 0.05050505
 0.06060606 0.07070707 0.08080808 0.09090909 0.1010101  0.11111111
 0.12121212 0.13131313 0.14141414 0.15151515 0.16161616 0.17171717
 0.18181818 0.19191919 0.2020202  0.21212121 0.22222222 0.23232323
 0.24242424 0.25252525 0.26262626 0.27272727 0.28282828 0.29292929
 0.3030303  0.31313131 0.32323232 0.33333333 0.34343434 0.35353535
 0.36363636 0.37373737 0.38383838 0.39393939 0.4040404  0.41414141
 0.42424242 0.43434343 0.44444444 0.45454545 0.46464646 0.47474747
 0.48484848 0.49494949 0.50505051 0.51515152 0.52525253 0.53535354
 0.54545455 0.55555556 0.56565657 0.57575758 0.58585859 0.5959596
 0.60606061 0.61616162 0.62626263 0.63636364 0.64646465 0.65656566
 0.66666667 0.67676768 0.68686869 0.6969697  0.70707071 0.71717172
 0.72727273 0.73737374 0.74747475 0.75757576 0.76767677 0.77777778
 0.78787879 0.7979798  0.80808081 0.81818182 0.82828283 0.83838384
 0.84848485 0.85858586 0.86868687 0.87878788 0.88888889 0.8989899
 0.90909091 0.91919192 0.92929293 0.93939394 0.94949495 0.95959596
 0.96969697 0.97979798 0.98989899 1.        ]
Set block size to 620 for training length 3102 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0014136991925324724
Params: {'gamma': np.float64(0.010101010101010102)} MFV MSE: 0.0014136873253127657
Params: {'gamma': np.float64(0.020202020202020204)} MFV MSE: 0.0014136755631831406
Params: {'gamma': np.float64(0.030303030303030304)} MFV MSE: 0.001413663906143597
Params: {'gamma': np.float64(0.04040404040404041)} MFV MSE: 0.0014136523541941344
Params: {'gamma': np.float64(0.05050505050505051)} MFV MSE: 0.001413640907334753
Params: {'gamma': np.float64(0.06060606060606061)} MFV MSE: 0.0014136295655654536
Params: {'gamma': np.float64(0.07070707070707072)} MFV MSE: 0.001413618328886235
Params: {'gamma': np.float64(0.08080808080808081)} MFV MSE: 0.0014136071972970982
Params: {'gamma': np.float64(0.09090909090909091)} MFV MSE: 0.0014135961707980424
Params: {'gamma': np.float64(0.10101010101010102)} MFV MSE: 0.0014135852493890684
Params: {'gamma': np.float64(0.11111111111111112)} MFV MSE: 0.001413574433070175
Params: {'gamma': np.float64(0.12121212121212122)} MFV MSE: 0.0014135637218413637
Params: {'gamma': np.float64(0.13131313131313133)} MFV MSE: 0.0014135531157026336
Params: {'gamma': np.float64(0.14141414141414144)} MFV MSE: 0.001413542614653984
Params: {'gamma': np.float64(0.15151515151515152)} MFV MSE: 0.0014135322186954165
Params: {'gamma': np.float64(0.16161616161616163)} MFV MSE: 0.0014135219278269301
Params: {'gamma': np.float64(0.17171717171717174)} MFV MSE: 0.0014135117420485254
Params: {'gamma': np.float64(0.18181818181818182)} MFV MSE: 0.001413501661360202
Params: {'gamma': np.float64(0.19191919191919193)} MFV MSE: 0.0014134916857619598
Params: {'gamma': np.float64(0.20202020202020204)} MFV MSE: 0.001413481815253799
Params: {'gamma': np.float64(0.21212121212121213)} MFV MSE: 0.0014134720498357198
Params: {'gamma': np.float64(0.22222222222222224)} MFV MSE: 0.001413462389507722
Params: {'gamma': np.float64(0.23232323232323235)} MFV MSE: 0.0014134528342698049
Params: {'gamma': np.float64(0.24242424242424243)} MFV MSE: 0.0014134433841219692
Params: {'gamma': np.float64(0.25252525252525254)} MFV MSE: 0.0014134340390642155
Params: {'gamma': np.float64(0.26262626262626265)} MFV MSE: 0.0014134247990965421
Params: {'gamma': np.float64(0.27272727272727276)} MFV MSE: 0.0014134156642189517
Params: {'gamma': np.float64(0.2828282828282829)} MFV MSE: 0.0014134066344314413
Params: {'gamma': np.float64(0.29292929292929293)} MFV MSE: 0.0014133977097340125
Params: {'gamma': np.float64(0.30303030303030304)} MFV MSE: 0.0014133888901266653
Params: {'gamma': np.float64(0.31313131313131315)} MFV MSE: 0.0014133801756093997
Params: {'gamma': np.float64(0.32323232323232326)} MFV MSE: 0.001413371566182215
Params: {'gamma': np.float64(0.33333333333333337)} MFV MSE: 0.0014133630618451117
Params: {'gamma': np.float64(0.3434343434343435)} MFV MSE: 0.0014133546625980894
Params: {'gamma': np.float64(0.3535353535353536)} MFV MSE: 0.0014133463684411493
Params: {'gamma': np.float64(0.36363636363636365)} MFV MSE: 0.0014133381793742903
Params: {'gamma': np.float64(0.37373737373737376)} MFV MSE: 0.0014133300953975121
Params: {'gamma': np.float64(0.38383838383838387)} MFV MSE: 0.0014133221165108156
Params: {'gamma': np.float64(0.393939393939394)} MFV MSE: 0.0014133142427142005
Params: {'gamma': np.float64(0.4040404040404041)} MFV MSE: 0.0014133064740076671
Params: {'gamma': np.float64(0.4141414141414142)} MFV MSE: 0.0014132988103912145
Params: {'gamma': np.float64(0.42424242424242425)} MFV MSE: 0.0014132912518648438
Params: {'gamma': np.float64(0.43434343434343436)} MFV MSE: 0.001413283798428554
Params: {'gamma': np.float64(0.4444444444444445)} MFV MSE: 0.0014132764500823455
Params: {'gamma': np.float64(0.4545454545454546)} MFV MSE: 0.0014132692068262182
Params: {'gamma': np.float64(0.4646464646464647)} MFV MSE: 0.0014132620686601728
Params: {'gamma': np.float64(0.4747474747474748)} MFV MSE: 0.0014132550355842083
Params: {'gamma': np.float64(0.48484848484848486)} MFV MSE: 0.0014132481075983252
Params: {'gamma': np.float64(0.494949494949495)} MFV MSE: 0.001413241284702524
Params: {'gamma': np.float64(0.5050505050505051)} MFV MSE: 0.0014132345668968036
Params: {'gamma': np.float64(0.5151515151515152)} MFV MSE: 0.0014132279541811646
Params: {'gamma': np.float64(0.5252525252525253)} MFV MSE: 0.0014132214465556073
Params: {'gamma': np.float64(0.5353535353535354)} MFV MSE: 0.0014132150440201313
Params: {'gamma': np.float64(0.5454545454545455)} MFV MSE: 0.0014132087465747363
Params: {'gamma': np.float64(0.5555555555555556)} MFV MSE: 0.0014132025542194229
Params: {'gamma': np.float64(0.5656565656565657)} MFV MSE: 0.0014131964669541908
Params: {'gamma': np.float64(0.5757575757575758)} MFV MSE: 0.00141319048477904
Params: {'gamma': np.float64(0.5858585858585859)} MFV MSE: 0.0014131846076939703
Params: {'gamma': np.float64(0.595959595959596)} MFV MSE: 0.0014131788356989824
Params: {'gamma': np.float64(0.6060606060606061)} MFV MSE: 0.001413173168794076
Params: {'gamma': np.float64(0.6161616161616162)} MFV MSE: 0.0014131676069792502
Params: {'gamma': np.float64(0.6262626262626263)} MFV MSE: 0.0014131621502545062
Params: {'gamma': np.float64(0.6363636363636365)} MFV MSE: 0.0014131567986198435
Params: {'gamma': np.float64(0.6464646464646465)} MFV MSE: 0.001413151552075262
Params: {'gamma': np.float64(0.6565656565656566)} MFV MSE: 0.0014131464106207623
Params: {'gamma': np.float64(0.6666666666666667)} MFV MSE: 0.0014131413742563437
Params: {'gamma': np.float64(0.6767676767676768)} MFV MSE: 0.0014131364429820065
Params: {'gamma': np.float64(0.686868686868687)} MFV MSE: 0.0014131316167977507
Params: {'gamma': np.float64(0.696969696969697)} MFV MSE: 0.0014131268957035762
Params: {'gamma': np.float64(0.7070707070707072)} MFV MSE: 0.0014131222796994827
Params: {'gamma': np.float64(0.7171717171717172)} MFV MSE: 0.0014131177687854715
Params: {'gamma': np.float64(0.7272727272727273)} MFV MSE: 0.0014131133629615405
Params: {'gamma': np.float64(0.7373737373737375)} MFV MSE: 0.0014131090622276916
Params: {'gamma': np.float64(0.7474747474747475)} MFV MSE: 0.001413104866583924
Params: {'gamma': np.float64(0.7575757575757577)} MFV MSE: 0.0014131007760302377
Params: {'gamma': np.float64(0.7676767676767677)} MFV MSE: 0.0014130967905666323
Params: {'gamma': np.float64(0.7777777777777778)} MFV MSE: 0.0014130929101931087
Params: {'gamma': np.float64(0.787878787878788)} MFV MSE: 0.0014130891349096659
Params: {'gamma': np.float64(0.797979797979798)} MFV MSE: 0.001413085464716305
Params: {'gamma': np.float64(0.8080808080808082)} MFV MSE: 0.0014130818996130254
Params: {'gamma': np.float64(0.8181818181818182)} MFV MSE: 0.001413078439599827
Params: {'gamma': np.float64(0.8282828282828284)} MFV MSE: 0.0014130750846767098
Params: {'gamma': np.float64(0.8383838383838385)} MFV MSE: 0.0014130718348436746
Params: {'gamma': np.float64(0.8484848484848485)} MFV MSE: 0.0014130686901007205
Params: {'gamma': np.float64(0.8585858585858587)} MFV MSE: 0.001413065650447847
Params: {'gamma': np.float64(0.8686868686868687)} MFV MSE: 0.0014130627158850557
Params: {'gamma': np.float64(0.8787878787878789)} MFV MSE: 0.0014130598864123456
Params: {'gamma': np.float64(0.888888888888889)} MFV MSE: 0.0014130571620297172
Params: {'gamma': np.float64(0.8989898989898991)} MFV MSE: 0.0014130545427371692
Params: {'gamma': np.float64(0.9090909090909092)} MFV MSE: 0.0014130520285347032
Params: {'gamma': np.float64(0.9191919191919192)} MFV MSE: 0.0014130496194223181
Params: {'gamma': np.float64(0.9292929292929294)} MFV MSE: 0.001413047315400015
Params: {'gamma': np.float64(0.9393939393939394)} MFV MSE: 0.0014130451164677928
Params: {'gamma': np.float64(0.9494949494949496)} MFV MSE: 0.0014130430226256525
Params: {'gamma': np.float64(0.9595959595959597)} MFV MSE: 0.001413041033873593
Params: {'gamma': np.float64(0.9696969696969697)} MFV MSE: 0.001413039150211615
Params: {'gamma': np.float64(0.9797979797979799)} MFV MSE: 0.0014130373716397184
Params: {'gamma': np.float64(0.98989898989899)} MFV MSE: 0.0014130356981579026
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0014130341297661688
Best gamma: 1.00 (MFV MSE: 0.001413), where gamma is the weight on the pre-break model.

--- Starting Bias-Variance Decomposition ---
Starting bias-variance decomposition with 50 rounds...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 10/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 20/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 30/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 40/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 50/50...
Decomposition complete.
OOS Metrics: {'MSFE': 0.0009822831867317464, 'RMSE': np.float64(0.03134139733215075), 'MAE': 0.0230982196962382}

--- Bias-Variance Decomposition Results ---
  MSE (from BVD): 0.000988
  Bias^2:         0.000986
  Variance:       0.000001
  Bias^2 + Var:   0.000988
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125415_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125415_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
