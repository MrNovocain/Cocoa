LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=1999, d=2
Generated bandwidth grid: [0.02817504 0.0469988  0.07839872 0.13077695 0.2181491  0.36389463
 0.60701283 1.01255842 1.68904925 2.81750395]
Set block size to 399 for training length 1999 and Q=4.
Best bandwidth for PRE-break model: 2.8175

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=4695, d=2
Generated bandwidth grid: [0.02443772 0.04076458 0.06799942 0.11342986 0.18921241 0.31562533
 0.52649478 0.87824622 1.46500299 2.44377228]
Set block size to 939 for training length 4695 and Q=4.
Best bandwidth for POST-break model: 2.4438

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 939 for training length 4695 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0010024619471361892
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0010024053966667162
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.001002352181001366
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0010023023001401385
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0010022557540830335
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.001002212542830051
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0010021726663811909
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.001002136124736453
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0010021029178958383
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0010020730458593456
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.001002046508626976
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0010020233061987284
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0010020034385746033
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0010019869057546012
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0010019737077387215
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.001001963844526964
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0010019573161193294
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.001001954122515817
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0010019542637164274
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.00100195773972116
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.001001964550530015
Best gamma: 0.85 (MFV MSE: 0.001002), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0009600852571648921, 'RMSE': np.float64(0.03098524257069633), 'MAE': 0.022510063690304078}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_203935_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_203935_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
