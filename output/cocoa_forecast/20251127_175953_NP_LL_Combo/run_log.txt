LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=1100, d=2
Generated bandwidth grid: [0.03112442 0.05191866 0.08660554 0.14446674 0.24098505 0.4019873
 0.67055523 1.11855354 1.86585975 3.11244166]
Set block size to 220 for training length 1100 and Q=4.
Best bandwidth for PRE-break model: 3.1124

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=5572, d=2
Generated bandwidth grid: [0.02375007 0.0396175  0.06608597 0.11023804 0.18388813 0.30674389
 0.51167965 0.85353311 1.42377903 2.37500657]
Set block size to 1114 for training length 5572 and Q=4.
Best bandwidth for POST-break model: 2.3750

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 1114 for training length 5572 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.013428213409141191
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.012230284550599957
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.011092612855638449
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.010015198324256652
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.008998040956454581
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.00804114075223223
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.007144497711589592
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.006308111834526678
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.005531983121043483
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.004816111571140007
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.004160497184816251
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0035651399620722124
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0030300399029078934
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0025551970073232964
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0021406112753184167
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0017862827068932574
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.001492211302047817
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0012583970607820958
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0010848399830960945
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0009715400689898122
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0009184973184632496
Best gamma: 1.00 (MFV MSE: 0.000918), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0014968265887364467, 'RMSE': np.float64(0.038688843207524914), 'MAE': 0.030173768409552246}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_175953_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_175953_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
