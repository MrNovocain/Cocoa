LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=3593, d=4
Generated bandwidth grid: [0.03593915 0.05995012 0.10000283 0.16681478 0.27826382 0.46417202
 0.7742856  1.29158622 2.15449567 3.59391538]
Set block size to 718 for training length 3593 and Q=4.
Best bandwidth for PRE-break model: 3.5939

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=3101, d=4
Generated bandwidth grid: [0.03660684 0.06106389 0.10186072 0.16991391 0.28343349 0.47279556
 0.78867053 1.31558173 2.1945226  3.66068432]
Set block size to 620 for training length 3101 and Q=4.
Best bandwidth for POST-break model: 3.6607

--- (3/3) Tuning gamma for Convex Combination model ---
Gamma values to test: [0.         0.01010101 0.02020202 0.03030303 0.04040404 0.05050505
 0.06060606 0.07070707 0.08080808 0.09090909 0.1010101  0.11111111
 0.12121212 0.13131313 0.14141414 0.15151515 0.16161616 0.17171717
 0.18181818 0.19191919 0.2020202  0.21212121 0.22222222 0.23232323
 0.24242424 0.25252525 0.26262626 0.27272727 0.28282828 0.29292929
 0.3030303  0.31313131 0.32323232 0.33333333 0.34343434 0.35353535
 0.36363636 0.37373737 0.38383838 0.39393939 0.4040404  0.41414141
 0.42424242 0.43434343 0.44444444 0.45454545 0.46464646 0.47474747
 0.48484848 0.49494949 0.50505051 0.51515152 0.52525253 0.53535354
 0.54545455 0.55555556 0.56565657 0.57575758 0.58585859 0.5959596
 0.60606061 0.61616162 0.62626263 0.63636364 0.64646465 0.65656566
 0.66666667 0.67676768 0.68686869 0.6969697  0.70707071 0.71717172
 0.72727273 0.73737374 0.74747475 0.75757576 0.76767677 0.77777778
 0.78787879 0.7979798  0.80808081 0.81818182 0.82828283 0.83838384
 0.84848485 0.85858586 0.86868687 0.87878788 0.88888889 0.8989899
 0.90909091 0.91919192 0.92929293 0.93939394 0.94949495 0.95959596
 0.96969697 0.97979798 0.98989899 1.        ]
Set block size to 620 for training length 3101 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0014136823420177625
Params: {'gamma': np.float64(0.010101010101010102)} MFV MSE: 0.0014136705669158106
Params: {'gamma': np.float64(0.020202020202020204)} MFV MSE: 0.0014136588984976018
Params: {'gamma': np.float64(0.030303030303030304)} MFV MSE: 0.001413647336763137
Params: {'gamma': np.float64(0.04040404040404041)} MFV MSE: 0.0014136358817124167
Params: {'gamma': np.float64(0.05050505050505051)} MFV MSE: 0.00141362453334544
Params: {'gamma': np.float64(0.06060606060606061)} MFV MSE: 0.0014136132916622072
Params: {'gamma': np.float64(0.07070707070707072)} MFV MSE: 0.001413602156662718
Params: {'gamma': np.float64(0.08080808080808081)} MFV MSE: 0.001413591128346973
Params: {'gamma': np.float64(0.09090909090909091)} MFV MSE: 0.0014135802067149715
Params: {'gamma': np.float64(0.10101010101010102)} MFV MSE: 0.001413569391766715
Params: {'gamma': np.float64(0.11111111111111112)} MFV MSE: 0.0014135586835022018
Params: {'gamma': np.float64(0.12121212121212122)} MFV MSE: 0.001413548081921432
Params: {'gamma': np.float64(0.13131313131313133)} MFV MSE: 0.0014135375870244066
Params: {'gamma': np.float64(0.14141414141414144)} MFV MSE: 0.0014135271988111248
Params: {'gamma': np.float64(0.15151515151515152)} MFV MSE: 0.001413516917281587
Params: {'gamma': np.float64(0.16161616161616163)} MFV MSE: 0.0014135067424357933
Params: {'gamma': np.float64(0.17171717171717174)} MFV MSE: 0.0014134966742737436
Params: {'gamma': np.float64(0.18181818181818182)} MFV MSE: 0.0014134867127954373
Params: {'gamma': np.float64(0.19191919191919193)} MFV MSE: 0.0014134768580008755
Params: {'gamma': np.float64(0.20202020202020204)} MFV MSE: 0.0014134671098900572
Params: {'gamma': np.float64(0.21212121212121213)} MFV MSE: 0.001413457468462983
Params: {'gamma': np.float64(0.22222222222222224)} MFV MSE: 0.0014134479337196526
Params: {'gamma': np.float64(0.23232323232323235)} MFV MSE: 0.0014134385056600663
Params: {'gamma': np.float64(0.24242424242424243)} MFV MSE: 0.0014134291842842234
Params: {'gamma': np.float64(0.25252525252525254)} MFV MSE: 0.0014134199695921253
Params: {'gamma': np.float64(0.26262626262626265)} MFV MSE: 0.0014134108615837706
Params: {'gamma': np.float64(0.27272727272727276)} MFV MSE: 0.0014134018602591596
Params: {'gamma': np.float64(0.2828282828282829)} MFV MSE: 0.0014133929656182929
Params: {'gamma': np.float64(0.29292929292929293)} MFV MSE: 0.00141338417766117
Params: {'gamma': np.float64(0.30303030303030304)} MFV MSE: 0.0014133754963877906
Params: {'gamma': np.float64(0.31313131313131315)} MFV MSE: 0.001413366921798155
Params: {'gamma': np.float64(0.32323232323232326)} MFV MSE: 0.0014133584538922642
Params: {'gamma': np.float64(0.33333333333333337)} MFV MSE: 0.0014133500926701169
Params: {'gamma': np.float64(0.3434343434343435)} MFV MSE: 0.0014133418381317136
Params: {'gamma': np.float64(0.3535353535353536)} MFV MSE: 0.0014133336902770535
Params: {'gamma': np.float64(0.36363636363636365)} MFV MSE: 0.0014133256491061384
Params: {'gamma': np.float64(0.37373737373737376)} MFV MSE: 0.0014133177146189663
Params: {'gamma': np.float64(0.38383838383838387)} MFV MSE: 0.0014133098868155385
Params: {'gamma': np.float64(0.393939393939394)} MFV MSE: 0.0014133021656958548
Params: {'gamma': np.float64(0.4040404040404041)} MFV MSE: 0.0014132945512599143
Params: {'gamma': np.float64(0.4141414141414142)} MFV MSE: 0.0014132870435077187
Params: {'gamma': np.float64(0.42424242424242425)} MFV MSE: 0.0014132796424392664
Params: {'gamma': np.float64(0.43434343434343436)} MFV MSE: 0.0014132723480545582
Params: {'gamma': np.float64(0.4444444444444445)} MFV MSE: 0.0014132651603535936
Params: {'gamma': np.float64(0.4545454545454546)} MFV MSE: 0.001413258079336373
Params: {'gamma': np.float64(0.4646464646464647)} MFV MSE: 0.0014132511050028965
Params: {'gamma': np.float64(0.4747474747474748)} MFV MSE: 0.001413244237353164
Params: {'gamma': np.float64(0.48484848484848486)} MFV MSE: 0.001413237476387175
Params: {'gamma': np.float64(0.494949494949495)} MFV MSE: 0.0014132308221049305
Params: {'gamma': np.float64(0.5050505050505051)} MFV MSE: 0.0014132242745064293
Params: {'gamma': np.float64(0.5151515151515152)} MFV MSE: 0.001413217833591672
Params: {'gamma': np.float64(0.5252525252525253)} MFV MSE: 0.0014132114993606589
Params: {'gamma': np.float64(0.5353535353535354)} MFV MSE: 0.00141320527181339
Params: {'gamma': np.float64(0.5454545454545455)} MFV MSE: 0.001413199150949865
Params: {'gamma': np.float64(0.5555555555555556)} MFV MSE: 0.0014131931367700832
Params: {'gamma': np.float64(0.5656565656565657)} MFV MSE: 0.0014131872292740457
Params: {'gamma': np.float64(0.5757575757575758)} MFV MSE: 0.001413181428461752
Params: {'gamma': np.float64(0.5858585858585859)} MFV MSE: 0.0014131757343332026
Params: {'gamma': np.float64(0.595959595959596)} MFV MSE: 0.001413170146888396
Params: {'gamma': np.float64(0.6060606060606061)} MFV MSE: 0.0014131646661273345
Params: {'gamma': np.float64(0.6161616161616162)} MFV MSE: 0.0014131592920500165
Params: {'gamma': np.float64(0.6262626262626263)} MFV MSE: 0.001413154024656443
Params: {'gamma': np.float64(0.6363636363636365)} MFV MSE: 0.0014131488639466125
Params: {'gamma': np.float64(0.6464646464646465)} MFV MSE: 0.0014131438099205266
Params: {'gamma': np.float64(0.6565656565656566)} MFV MSE: 0.001413138862578184
Params: {'gamma': np.float64(0.6666666666666667)} MFV MSE: 0.0014131340219195854
Params: {'gamma': np.float64(0.6767676767676768)} MFV MSE: 0.001413129287944731
Params: {'gamma': np.float64(0.686868686868687)} MFV MSE: 0.0014131246606536203
Params: {'gamma': np.float64(0.696969696969697)} MFV MSE: 0.0014131201400462534
Params: {'gamma': np.float64(0.7070707070707072)} MFV MSE: 0.0014131157261226307
Params: {'gamma': np.float64(0.7171717171717172)} MFV MSE: 0.0014131114188827517
Params: {'gamma': np.float64(0.7272727272727273)} MFV MSE: 0.0014131072183266168
Params: {'gamma': np.float64(0.7373737373737375)} MFV MSE: 0.0014131031244542258
Params: {'gamma': np.float64(0.7474747474747475)} MFV MSE: 0.001413099137265579
Params: {'gamma': np.float64(0.7575757575757577)} MFV MSE: 0.0014130952567606755
Params: {'gamma': np.float64(0.7676767676767677)} MFV MSE: 0.001413091482939516
Params: {'gamma': np.float64(0.7777777777777778)} MFV MSE: 0.0014130878158021005
Params: {'gamma': np.float64(0.787878787878788)} MFV MSE: 0.0014130842553484288
Params: {'gamma': np.float64(0.797979797979798)} MFV MSE: 0.0014130808015785014
Params: {'gamma': np.float64(0.8080808080808082)} MFV MSE: 0.0014130774544923175
Params: {'gamma': np.float64(0.8181818181818182)} MFV MSE: 0.0014130742140898776
Params: {'gamma': np.float64(0.8282828282828284)} MFV MSE: 0.0014130710803711818
Params: {'gamma': np.float64(0.8383838383838385)} MFV MSE: 0.0014130680533362297
Params: {'gamma': np.float64(0.8484848484848485)} MFV MSE: 0.0014130651329850217
Params: {'gamma': np.float64(0.8585858585858587)} MFV MSE: 0.0014130623193175573
Params: {'gamma': np.float64(0.8686868686868687)} MFV MSE: 0.0014130596123338372
Params: {'gamma': np.float64(0.8787878787878789)} MFV MSE: 0.0014130570120338606
Params: {'gamma': np.float64(0.888888888888889)} MFV MSE: 0.0014130545184176287
Params: {'gamma': np.float64(0.8989898989898991)} MFV MSE: 0.00141305213148514
Params: {'gamma': np.float64(0.9090909090909092)} MFV MSE: 0.001413049851236395
Params: {'gamma': np.float64(0.9191919191919192)} MFV MSE: 0.0014130476776713942
Params: {'gamma': np.float64(0.9292929292929294)} MFV MSE: 0.0014130456107901374
Params: {'gamma': np.float64(0.9393939393939394)} MFV MSE: 0.0014130436505926246
Params: {'gamma': np.float64(0.9494949494949496)} MFV MSE: 0.0014130417970788557
Params: {'gamma': np.float64(0.9595959595959597)} MFV MSE: 0.0014130400502488304
Params: {'gamma': np.float64(0.9696969696969697)} MFV MSE: 0.0014130384101025493
Params: {'gamma': np.float64(0.9797979797979799)} MFV MSE: 0.001413036876640012
Params: {'gamma': np.float64(0.98989898989899)} MFV MSE: 0.0014130354498612184
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0014130341297661688
Best gamma: 1.00 (MFV MSE: 0.001413), where gamma is the weight on the pre-break model.

--- Starting Bias-Variance Decomposition ---
Starting bias-variance decomposition with 50 rounds...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 10/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 20/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 30/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 40/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 50/50...
Decomposition complete.
OOS Metrics: {'MSFE': 0.0009822851441155197, 'RMSE': np.float64(0.03134142855894606), 'MAE': 0.023096857961480532}

--- Bias-Variance Decomposition Results ---
  MSE (from BVD): 0.000988
  Bias^2:         0.000986
  Variance:       0.000001
  Bias^2 + Var:   0.000988
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125418_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125418_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
