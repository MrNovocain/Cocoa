LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=2400, d=2
Generated bandwidth grid: [0.02732949 0.04558833 0.07604592 0.12685224 0.21160228 0.35297388
 0.58879592 0.98217079 1.63835963 2.73294857]
Set block size to 480 for training length 2400 and Q=4.
Best bandwidth for PRE-break model: 2.7329

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=4272, d=2
Generated bandwidth grid: [0.02482532 0.04141112 0.06907792 0.11522891 0.19221341 0.32063129
 0.53484523 0.89217561 1.48823862 2.48253164]
Set block size to 854 for training length 4272 and Q=4.
Best bandwidth for POST-break model: 0.3206

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 854 for training length 4272 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0010917853550523637
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0010896721168879451
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0010876531727439817
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0010857285226204734
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0010838981665174197
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0010821621044348204
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0010805203363726764
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0010789728623309869
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0010775196823097524
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0010761607963089726
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0010748962043286476
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0010737259063687775
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0010726499024293623
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0010716681925104017
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0010707807766118964
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0010699876547338452
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0010692888268762494
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.001068684293039108
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0010681740532224218
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0010677581074261904
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.001067436455650413
Best gamma: 1.00 (MFV MSE: 0.001067), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0013243262725553793, 'RMSE': np.float64(0.03639129391153026), 'MAE': 0.027148483821584135}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_180011_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_180011_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
