LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=2299, d=4
Generated bandwidth grid: [0.0380021  0.06339133 0.10574311 0.17639014 0.29423648 0.49081603
 0.81873049 1.36572476 2.27816621 3.80021028]
Set block size to 459 for training length 2299 and Q=4.
Best bandwidth for PRE-break model: 3.8002

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=4395, d=4
Generated bandwidth grid: [0.03504533 0.05845913 0.09751571 0.16266601 0.27134325 0.45262783
 0.75502872 1.25946382 2.10091227 3.50453289]
Set block size to 879 for training length 4395 and Q=4.
Best bandwidth for POST-break model: 3.5045

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 879 for training length 4395 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.001057753026831766
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0010576320439152208
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0010575183319231026
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.001057411890855411
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0010573127207121464
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0010572208214933078
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.001057136193198896
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0010570588358289111
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0010569887493833534
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0010569259338622217
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.001056870389265517
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.001056822115593239
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0010567811128453877
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.001056747381021963
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.001056720920122965
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0010567017301483937
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0010566898110982493
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0010566851629725312
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0010566877857712401
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0010566976794943756
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0010567148441419378
Best gamma: 0.85 (MFV MSE: 0.001057), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0009857937023334767, 'RMSE': np.float64(0.03139735183631697), 'MAE': 0.023167624199603346}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_212535_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_212535_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
