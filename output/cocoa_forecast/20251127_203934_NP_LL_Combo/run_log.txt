LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=1799, d=2
Generated bandwidth grid: [0.02867443 0.04783183 0.07978831 0.13309492 0.2220157  0.37034452
 0.61777188 1.03050561 1.71898697 2.86744308]
Set block size to 359 for training length 1799 and Q=4.
Best bandwidth for PRE-break model: 2.8674

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=4895, d=2
Generated bandwidth grid: [0.0242684  0.04048214 0.06752828 0.11264395 0.18790144 0.31343849
 0.52284692 0.87216122 1.4548526  2.42684041]
Set block size to 979 for training length 4895 and Q=4.
Best bandwidth for POST-break model: 2.4268

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 979 for training length 4895 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0009755897159966737
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0009754829245948946
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0009753866516166045
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0009753008970618032
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0009752256609304908
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0009751609432226675
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0009751067439383329
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0009750630630774874
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0009750299006401306
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0009750072566262626
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0009749951310358838
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0009749935238689935
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0009750024351255924
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0009750218648056803
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0009750518129092568
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0009750922794363223
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0009751432643868769
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0009752047677609202
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0009752767895584524
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0009753593297794734
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0009754523884239836
Best gamma: 0.55 (MFV MSE: 0.000975), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0009620729423777463, 'RMSE': np.float64(0.031017300694576023), 'MAE': 0.02259668063862861}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_203934_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_203934_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
