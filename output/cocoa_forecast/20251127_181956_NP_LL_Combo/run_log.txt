LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=1000, d=2
Generated bandwidth grid: [0.03162278 0.05274997 0.08799225 0.14677993 0.24484367 0.40842387
 0.68129207 1.13646367 1.89573565 3.16227766]
Set block size to 200 for training length 1000 and Q=4.
Best bandwidth for PRE-break model: 3.1623

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=5672, d=2
Generated bandwidth grid: [0.02367976 0.03950022 0.06589034 0.10991171 0.18334378 0.30583586
 0.51016496 0.85100645 1.41956432 2.367976  ]
Set block size to 1134 for training length 5672 and Q=4.
Best bandwidth for POST-break model: 2.3680

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 1134 for training length 5672 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0012736554032358293
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0012389811146615122
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0012059758482152248
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0011746396038969668
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0011449723817067393
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0011169741816445416
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0010906450037103741
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.001065984847904236
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0010429937142261282
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0010216716026760502
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0010020185132540022
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.000984034445959984
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0009677194007939956
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0009530733777560377
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0009400963768461091
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0009287883980642108
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0009191494414103423
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0009111795068845036
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0009048785944866949
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0009002467042169164
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0008972838360751675
Best gamma: 1.00 (MFV MSE: 0.000897), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0014201240018842688, 'RMSE': np.float64(0.0376845326610835), 'MAE': 0.028969285010805642}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_181956_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_181956_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
