LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=3591, d=4
Generated bandwidth grid: [0.03594166 0.05995429 0.10000979 0.16682639 0.27828318 0.46420433
 0.77433949 1.29167612 2.15464563 3.59416553]
Set block size to 718 for training length 3591 and Q=4.
Best bandwidth for PRE-break model: 3.5942

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=3103, d=4
Generated bandwidth grid: [0.03660389 0.06105897 0.10185251 0.16990022 0.28341065 0.47275746
 0.78860697 1.31547571 2.19434574 3.66038931]
Set block size to 620 for training length 3103 and Q=4.
Best bandwidth for POST-break model: 3.6604

--- (3/3) Tuning gamma for Convex Combination model ---
Gamma values to test: [0.         0.01010101 0.02020202 0.03030303 0.04040404 0.05050505
 0.06060606 0.07070707 0.08080808 0.09090909 0.1010101  0.11111111
 0.12121212 0.13131313 0.14141414 0.15151515 0.16161616 0.17171717
 0.18181818 0.19191919 0.2020202  0.21212121 0.22222222 0.23232323
 0.24242424 0.25252525 0.26262626 0.27272727 0.28282828 0.29292929
 0.3030303  0.31313131 0.32323232 0.33333333 0.34343434 0.35353535
 0.36363636 0.37373737 0.38383838 0.39393939 0.4040404  0.41414141
 0.42424242 0.43434343 0.44444444 0.45454545 0.46464646 0.47474747
 0.48484848 0.49494949 0.50505051 0.51515152 0.52525253 0.53535354
 0.54545455 0.55555556 0.56565657 0.57575758 0.58585859 0.5959596
 0.60606061 0.61616162 0.62626263 0.63636364 0.64646465 0.65656566
 0.66666667 0.67676768 0.68686869 0.6969697  0.70707071 0.71717172
 0.72727273 0.73737374 0.74747475 0.75757576 0.76767677 0.77777778
 0.78787879 0.7979798  0.80808081 0.81818182 0.82828283 0.83838384
 0.84848485 0.85858586 0.86868687 0.87878788 0.88888889 0.8989899
 0.90909091 0.91919192 0.92929293 0.93939394 0.94949495 0.95959596
 0.96969697 0.97979798 0.98989899 1.        ]
Set block size to 620 for training length 3103 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0014136977485767067
Params: {'gamma': np.float64(0.010101010101010102)} MFV MSE: 0.0014136858864962653
Params: {'gamma': np.float64(0.020202020202020204)} MFV MSE: 0.0014136741296986847
Params: {'gamma': np.float64(0.030303030303030304)} MFV MSE: 0.0014136624781839636
Params: {'gamma': np.float64(0.04040404040404041)} MFV MSE: 0.001413650931952102
Params: {'gamma': np.float64(0.05050505050505051)} MFV MSE: 0.0014136394910031008
Params: {'gamma': np.float64(0.06060606060606061)} MFV MSE: 0.0014136281553369591
Params: {'gamma': np.float64(0.07070707070707072)} MFV MSE: 0.0014136169249536772
Params: {'gamma': np.float64(0.08080808080808081)} MFV MSE: 0.0014136057998532553
Params: {'gamma': np.float64(0.09090909090909091)} MFV MSE: 0.0014135947800356936
Params: {'gamma': np.float64(0.10101010101010102)} MFV MSE: 0.0014135838655009913
Params: {'gamma': np.float64(0.11111111111111112)} MFV MSE: 0.0014135730562491486
Params: {'gamma': np.float64(0.12121212121212122)} MFV MSE: 0.0014135623522801661
Params: {'gamma': np.float64(0.13131313131313133)} MFV MSE: 0.0014135517535940434
Params: {'gamma': np.float64(0.14141414141414144)} MFV MSE: 0.0014135412601907805
Params: {'gamma': np.float64(0.15151515151515152)} MFV MSE: 0.0014135308720703774
Params: {'gamma': np.float64(0.16161616161616163)} MFV MSE: 0.0014135205892328345
Params: {'gamma': np.float64(0.17171717171717174)} MFV MSE: 0.0014135104116781514
Params: {'gamma': np.float64(0.18181818181818182)} MFV MSE: 0.0014135003394063277
Params: {'gamma': np.float64(0.19191919191919193)} MFV MSE: 0.001413490372417364
Params: {'gamma': np.float64(0.20202020202020204)} MFV MSE: 0.00141348051071126
Params: {'gamma': np.float64(0.21212121212121213)} MFV MSE: 0.0014134707542880164
Params: {'gamma': np.float64(0.22222222222222224)} MFV MSE: 0.0014134611031476323
Params: {'gamma': np.float64(0.23232323232323235)} MFV MSE: 0.001413451557290108
Params: {'gamma': np.float64(0.24242424242424243)} MFV MSE: 0.0014134421167154435
Params: {'gamma': np.float64(0.25252525252525254)} MFV MSE: 0.0014134327814236387
Params: {'gamma': np.float64(0.26262626262626265)} MFV MSE: 0.0014134235514146943
Params: {'gamma': np.float64(0.27272727272727276)} MFV MSE: 0.0014134144266886098
Params: {'gamma': np.float64(0.2828282828282829)} MFV MSE: 0.0014134054072453843
Params: {'gamma': np.float64(0.29292929292929293)} MFV MSE: 0.0014133964930850194
Params: {'gamma': np.float64(0.30303030303030304)} MFV MSE: 0.001413387684207514
Params: {'gamma': np.float64(0.31313131313131315)} MFV MSE: 0.0014133789806128683
Params: {'gamma': np.float64(0.32323232323232326)} MFV MSE: 0.0014133703823010827
Params: {'gamma': np.float64(0.33333333333333337)} MFV MSE: 0.0014133618892721567
Params: {'gamma': np.float64(0.3434343434343435)} MFV MSE: 0.0014133535015260908
Params: {'gamma': np.float64(0.3535353535353536)} MFV MSE: 0.0014133452190628847
Params: {'gamma': np.float64(0.36363636363636365)} MFV MSE: 0.0014133370418825386
Params: {'gamma': np.float64(0.37373737373737376)} MFV MSE: 0.001413328969985052
Params: {'gamma': np.float64(0.38383838383838387)} MFV MSE: 0.0014133210033704254
Params: {'gamma': np.float64(0.393939393939394)} MFV MSE: 0.0014133131420386584
Params: {'gamma': np.float64(0.4040404040404041)} MFV MSE: 0.0014133053859897518
Params: {'gamma': np.float64(0.4141414141414142)} MFV MSE: 0.0014132977352237048
Params: {'gamma': np.float64(0.42424242424242425)} MFV MSE: 0.0014132901897405173
Params: {'gamma': np.float64(0.43434343434343436)} MFV MSE: 0.00141328274954019
Params: {'gamma': np.float64(0.4444444444444445)} MFV MSE: 0.0014132754146227227
Params: {'gamma': np.float64(0.4545454545454546)} MFV MSE: 0.0014132681849881154
Params: {'gamma': np.float64(0.4646464646464647)} MFV MSE: 0.001413261060636367
Params: {'gamma': np.float64(0.4747474747474748)} MFV MSE: 0.001413254041567479
Params: {'gamma': np.float64(0.48484848484848486)} MFV MSE: 0.0014132471277814506
Params: {'gamma': np.float64(0.494949494949495)} MFV MSE: 0.0014132403192782825
Params: {'gamma': np.float64(0.5050505050505051)} MFV MSE: 0.0014132336160579742
Params: {'gamma': np.float64(0.5151515151515152)} MFV MSE: 0.0014132270181205257
Params: {'gamma': np.float64(0.5252525252525253)} MFV MSE: 0.0014132205254659368
Params: {'gamma': np.float64(0.5353535353535354)} MFV MSE: 0.0014132141380942078
Params: {'gamma': np.float64(0.5454545454545455)} MFV MSE: 0.0014132078560053385
Params: {'gamma': np.float64(0.5555555555555556)} MFV MSE: 0.0014132016791993296
Params: {'gamma': np.float64(0.5656565656565657)} MFV MSE: 0.0014131956076761803
Params: {'gamma': np.float64(0.5757575757575758)} MFV MSE: 0.0014131896414358903
Params: {'gamma': np.float64(0.5858585858585859)} MFV MSE: 0.001413183780478461
Params: {'gamma': np.float64(0.595959595959596)} MFV MSE: 0.0014131780248038909
Params: {'gamma': np.float64(0.6060606060606061)} MFV MSE: 0.001413172374412181
Params: {'gamma': np.float64(0.6161616161616162)} MFV MSE: 0.0014131668293033309
Params: {'gamma': np.float64(0.6262626262626263)} MFV MSE: 0.0014131613894773404
Params: {'gamma': np.float64(0.6363636363636365)} MFV MSE: 0.0014131560549342098
Params: {'gamma': np.float64(0.6464646464646465)} MFV MSE: 0.0014131508256739395
Params: {'gamma': np.float64(0.6565656565656566)} MFV MSE: 0.001413145701696528
Params: {'gamma': np.float64(0.6666666666666667)} MFV MSE: 0.0014131406830019777
Params: {'gamma': np.float64(0.6767676767676768)} MFV MSE: 0.0014131357695902865
Params: {'gamma': np.float64(0.686868686868687)} MFV MSE: 0.0014131309614614552
Params: {'gamma': np.float64(0.696969696969697)} MFV MSE: 0.0014131262586154839
Params: {'gamma': np.float64(0.7070707070707072)} MFV MSE: 0.0014131216610523724
Params: {'gamma': np.float64(0.7171717171717172)} MFV MSE: 0.0014131171687721208
Params: {'gamma': np.float64(0.7272727272727273)} MFV MSE: 0.0014131127817747287
Params: {'gamma': np.float64(0.7373737373737375)} MFV MSE: 0.0014131085000601965
Params: {'gamma': np.float64(0.7474747474747475)} MFV MSE: 0.0014131043236285242
Params: {'gamma': np.float64(0.7575757575757577)} MFV MSE: 0.001413100252479712
Params: {'gamma': np.float64(0.7676767676767677)} MFV MSE: 0.0014130962866137596
Params: {'gamma': np.float64(0.7777777777777778)} MFV MSE: 0.0014130924260306666
Params: {'gamma': np.float64(0.787878787878788)} MFV MSE: 0.0014130886707304344
Params: {'gamma': np.float64(0.797979797979798)} MFV MSE: 0.0014130850207130614
Params: {'gamma': np.float64(0.8080808080808082)} MFV MSE: 0.001413081475978548
Params: {'gamma': np.float64(0.8181818181818182)} MFV MSE: 0.001413078036526895
Params: {'gamma': np.float64(0.8282828282828284)} MFV MSE: 0.0014130747023581012
Params: {'gamma': np.float64(0.8383838383838385)} MFV MSE: 0.0014130714734721676
Params: {'gamma': np.float64(0.8484848484848485)} MFV MSE: 0.001413068349869094
Params: {'gamma': np.float64(0.8585858585858587)} MFV MSE: 0.00141306533154888
Params: {'gamma': np.float64(0.8686868686868687)} MFV MSE: 0.001413062418511526
Params: {'gamma': np.float64(0.8787878787878789)} MFV MSE: 0.0014130596107570317
Params: {'gamma': np.float64(0.888888888888889)} MFV MSE: 0.001413056908285397
Params: {'gamma': np.float64(0.8989898989898991)} MFV MSE: 0.0014130543110966228
Params: {'gamma': np.float64(0.9090909090909092)} MFV MSE: 0.0014130518191907081
Params: {'gamma': np.float64(0.9191919191919192)} MFV MSE: 0.0014130494325676533
Params: {'gamma': np.float64(0.9292929292929294)} MFV MSE: 0.0014130471512274582
Params: {'gamma': np.float64(0.9393939393939394)} MFV MSE: 0.001413044975170123
Params: {'gamma': np.float64(0.9494949494949496)} MFV MSE: 0.0014130429043956478
Params: {'gamma': np.float64(0.9595959595959597)} MFV MSE: 0.0014130409389040324
Params: {'gamma': np.float64(0.9696969696969697)} MFV MSE: 0.001413039078695277
Params: {'gamma': np.float64(0.9797979797979799)} MFV MSE: 0.001413037323769381
Params: {'gamma': np.float64(0.98989898989899)} MFV MSE: 0.0014130356741263446
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0014130341297661688
Best gamma: 1.00 (MFV MSE: 0.001413), where gamma is the weight on the pre-break model.

--- Starting Bias-Variance Decomposition ---
Starting bias-variance decomposition with 50 rounds...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 10/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 20/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 30/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 40/50...
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
LocalPolynomialEngine will use device: cuda
  Completed round 50/50...
Decomposition complete.
OOS Metrics: {'MSFE': 0.0009822909832386752, 'RMSE': np.float64(0.03134152171223783), 'MAE': 0.023098057215009727}

--- Bias-Variance Decomposition Results ---
  MSE (from BVD): 0.000988
  Bias^2:         0.000986
  Variance:       0.000001
  Bias^2 + Var:   0.000988
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125413_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251128_125413_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
