LocalPolynomialEngine will use device: cuda

--- (1/3) Tuning bandwidth for PRE-break model ---
Creating bandwidth grid with T=6604, d=3
Generated bandwidth grid: [0.02846514 0.04748271 0.07920593 0.13212346 0.22039522 0.36764138
 0.61326278 1.02298398 1.70644012 2.84651369]
Set block size to 1320 for training length 6604 and Q=4.
Best bandwidth for PRE-break model: 2.8465

--- (2/3) Tuning bandwidth for POST-break model ---
Creating bandwidth grid with T=90, d=3
Generated bandwidth grid: [0.05258023 0.08770911 0.14630762 0.24405582 0.40710964 0.67909981
 1.13280676 1.88963556 3.1521021  5.25802321]
Set block size to 18 for training length 90 and Q=4.
Best bandwidth for POST-break model: 5.2580

--- (3/3) Tuning gamma for Convex Combination model ---
Set block size to 18 for training length 90 and Q=4.
Params: {'gamma': np.float64(0.0)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.05)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.1)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.15000000000000002)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.2)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.25)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.30000000000000004)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.35000000000000003)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.4)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.45)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.5)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.55)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.6000000000000001)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.65)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.7000000000000001)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.75)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.8)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.8500000000000001)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.9)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(0.9500000000000001)} MFV MSE: 0.0018205600425408378
Params: {'gamma': np.float64(1.0)} MFV MSE: 0.0018205600425408378
Best gamma: 0.00 (MFV MSE: 0.001821), where gamma is the weight on the pre-break model.

--- Bias-Variance Decomposition is temporarily disabled ---
OOS Metrics: {'MSFE': 0.0010536820123140608, 'RMSE': np.float64(0.03246046845493855), 'MAE': 0.024510719469038773}
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_182929_NP_LL_Combo\full_forecast.png
Plot saved to w:/Research/NP/Cocoa/output/cocoa_forecast\20251127_182929_NP_LL_Combo\oos_forecast.png
Successfully completed run for NP_LL_Combo.
